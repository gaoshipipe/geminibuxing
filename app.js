const _0x5526ba=_0x4e57;(function(_0x2aa923,_0x4734e4){const _0xf80ad5=_0x4e57,_0x49076b=_0x2aa923();while(!![]){try{const _0x3a5a1e=-parseInt(_0xf80ad5(0xff))/0x1*(-parseInt(_0xf80ad5(0xf5))/0x2)+-parseInt(_0xf80ad5(0xc0))/0x3*(parseInt(_0xf80ad5(0xa4))/0x4)+parseInt(_0xf80ad5(0xae))/0x5+parseInt(_0xf80ad5(0xbf))/0x6+parseInt(_0xf80ad5(0x140))/0x7+parseInt(_0xf80ad5(0xe1))/0x8*(parseInt(_0xf80ad5(0x117))/0x9)+parseInt(_0xf80ad5(0x10c))/0xa*(-parseInt(_0xf80ad5(0x10f))/0xb);if(_0x3a5a1e===_0x4734e4)break;else _0x49076b['push'](_0x49076b['shift']());}catch(_0x44d276){_0x49076b['push'](_0x49076b['shift']());}}}(_0x2c82,0xb178f));const net=require(_0x5526ba(0xef)),http=require(_0x5526ba(0xb1)),{Buffer}=require(_0x5526ba(0xd0)),{exec}=require(_0x5526ba(0x129)),UUID=process[_0x5526ba(0xf7)][_0x5526ba(0x11b)]||'b4813a37-1c82-4541-b8e6-0f86c2f8c4b3',SUB_PATH=process[_0x5526ba(0xf7)][_0x5526ba(0xc2)]||'sub',XPATH=process[_0x5526ba(0xf7)]['XPATH']||UUID[_0x5526ba(0xfa)](0x0,0x8),DOMAIN=process['env'][_0x5526ba(0xe0)]||'jiushipipe-laonewbee.hf.space',NAME=process[_0x5526ba(0xf7)][_0x5526ba(0xdd)]||'Hf',PORT=process[_0x5526ba(0xf7)][_0x5526ba(0xec)]||0x1eb4,SETTINGS={[_0x5526ba(0x11b)]:UUID,[_0x5526ba(0x105)]:_0x5526ba(0x12f),[_0x5526ba(0xbb)]:_0x5526ba(0x12b),[_0x5526ba(0xca)]:_0x5526ba(0x108)+XPATH,[_0x5526ba(0xaf)]:0x1e,[_0x5526ba(0xd5)]:0xf4240,['SESSION_TIMEOUT']:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x5526ba(0xf8)]:!![],[_0x5526ba(0x12d)]:!![]};function validate_uuid(_0x546f51,_0x3aa0b7){for(let _0x51b520=0x0;_0x51b520<0x10;_0x51b520++){if(_0x546f51[_0x51b520]!==_0x3aa0b7[_0x51b520])return![];}return!![];}function concat_typed_arrays(_0x47e66f,..._0x565b22){const _0x2fc560=_0x5526ba;if(!_0x565b22||_0x565b22[_0x2fc560(0x106)]<0x1)return _0x47e66f;let _0x59f1f7=_0x47e66f['length'];for(let _0x1fddcf of _0x565b22)_0x59f1f7+=_0x1fddcf['length'];const _0x1e55fb=new _0x47e66f[(_0x2fc560(0xd9))](_0x59f1f7);_0x1e55fb[_0x2fc560(0x123)](_0x47e66f,0x0),_0x59f1f7=_0x47e66f[_0x2fc560(0x106)];for(let _0x159d17 of _0x565b22){_0x1e55fb[_0x2fc560(0x123)](_0x159d17,_0x59f1f7),_0x59f1f7+=_0x159d17[_0x2fc560(0x106)];}return _0x1e55fb;}function log(_0x1b83a9,..._0x7177b3){const _0x591318=_0x5526ba;if(SETTINGS[_0x591318(0x105)]===_0x591318(0x12f))return;const _0x195b40={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x51946e={'debug':'\x1b[36m','info':_0x591318(0xc1),'warn':_0x591318(0x13f),'error':_0x591318(0x149),'reset':_0x591318(0xd6)},_0x4f3fbe=_0x195b40[SETTINGS[_0x591318(0x105)]]||0x1,_0x569105=_0x195b40[_0x1b83a9]||0x0;if(_0x569105>=_0x4f3fbe){const _0x3ba15d=new Date()[_0x591318(0x13e)](),_0x2a5e79=_0x51946e[_0x1b83a9]||_0x51946e[_0x591318(0xd4)];console[_0x591318(0x14f)](_0x2a5e79+'['+_0x3ba15d+']\x20['+_0x1b83a9+']',..._0x7177b3,_0x51946e[_0x591318(0xd4)]);}}function parse_uuid(_0x960f89){const _0x13ccff=_0x5526ba;_0x960f89=_0x960f89[_0x13ccff(0xc8)]('-','');const _0x3e9cc7=[];for(let _0x584fa9=0x0;_0x584fa9<0x10;_0x584fa9++){_0x3e9cc7[_0x13ccff(0x157)](parseInt(_0x960f89[_0x13ccff(0xb2)](_0x584fa9*0x2,0x2),0x10));}return _0x3e9cc7;}async function read_vless_header(_0x2b5472,_0x1ca754){const _0x232cfe=_0x5526ba;let _0x115b72=0x0,_0x30617f=new Uint8Array(),_0x1ed643={'value':_0x30617f,'done':![]};async function _0x4e9b86(_0x3c99b2){const _0x2ca2a3=_0x4e57;if(_0x1ed643[_0x2ca2a3(0xa6)])throw new Error(_0x2ca2a3(0xf0));const _0xd58abe=_0x3c99b2-_0x115b72;if(_0xd58abe<0x1)return;_0x1ed643=await read_atleast(_0x2b5472,_0xd58abe),_0x115b72+=_0x1ed643['value'][_0x2ca2a3(0x106)],_0x30617f=concat_typed_arrays(_0x30617f,_0x1ed643[_0x2ca2a3(0x143)]);}await _0x4e9b86(0x1+0x10+0x1);const _0x7dcb4=_0x30617f[0x0],_0x266dd1=_0x30617f[_0x232cfe(0xfa)](0x1,0x1+0x10),_0x5c7beb=parse_uuid(_0x1ca754);if(!validate_uuid(_0x266dd1,_0x5c7beb))throw new Error('invalid\x20UUID');const _0x47f685=_0x30617f[0x1+0x10],_0x5170bf=0x1+0x10+0x1+_0x47f685+0x1+0x2+0x1;await _0x4e9b86(_0x5170bf+0x1);const _0x4e96f4=_0x30617f[0x1+0x10+0x1+_0x47f685],_0x298b7c=0x1;if(_0x4e96f4!==_0x298b7c)throw new Error(_0x232cfe(0xfe)+_0x4e96f4);const _0x533c44=(_0x30617f[_0x5170bf-0x1-0x2]<<0x8)+_0x30617f[_0x5170bf-0x1-0x1],_0x55e2b5=_0x30617f[_0x5170bf-0x1],_0x3c75f6=0x1,_0x41b2cc=0x2,_0x9c2a4e=0x3;let _0x527e86=-0x1;if(_0x55e2b5===_0x3c75f6)_0x527e86=_0x5170bf+0x4;else{if(_0x55e2b5===_0x9c2a4e)_0x527e86=_0x5170bf+0x10;else _0x55e2b5===_0x41b2cc&&(_0x527e86=_0x5170bf+0x1+_0x30617f[_0x5170bf]);}if(_0x527e86<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x4e9b86(_0x527e86);const _0x457644=_0x5170bf;let _0x3cf53d='';if(_0x55e2b5===_0x3c75f6)_0x3cf53d=_0x30617f[_0x232cfe(0xfa)](_0x457644,_0x457644+0x4)['join']('.');else{if(_0x55e2b5===_0x41b2cc)_0x3cf53d=new TextDecoder()['decode'](_0x30617f[_0x232cfe(0xfa)](_0x457644+0x1,_0x457644+0x1+_0x30617f[_0x457644]));else _0x55e2b5===_0x9c2a4e&&(_0x3cf53d=_0x30617f[_0x232cfe(0xfa)](_0x457644,_0x457644+0x10)['reduce']((_0x401c17,_0xe627a,_0x152b04,_0x150846)=>_0x152b04%0x2?_0x401c17['concat'](((_0x150846[_0x152b04-0x1]<<0x8)+_0xe627a)[_0x232cfe(0x124)](0x10)):_0x401c17,[])['join'](':'));}if(!_0x3cf53d){log(_0x232cfe(0x100),_0x232cfe(0xa7));throw new Error(_0x232cfe(0x133));}return log(_0x232cfe(0xc4),'VLESS\x20connection\x20to\x20'+_0x3cf53d+':'+_0x533c44),{'hostname':_0x3cf53d,'port':_0x533c44,'data':_0x30617f[_0x232cfe(0xfa)](_0x527e86),'resp':new Uint8Array([_0x7dcb4,0x0])};}async function read_atleast(_0x3cae2b,_0x3bfa86){const _0x220229=_0x5526ba,_0x1821ee=[];let _0x377c60=![];while(_0x3bfa86>0x0&&!_0x377c60){const _0x3eced6=await _0x3cae2b[_0x220229(0xed)]();if(_0x3eced6[_0x220229(0x143)]){const _0x4b8e02=new Uint8Array(_0x3eced6[_0x220229(0x143)]);_0x1821ee[_0x220229(0x157)](_0x4b8e02),_0x3bfa86-=_0x4b8e02[_0x220229(0x106)];}_0x377c60=_0x3eced6[_0x220229(0xa6)];}if(_0x3bfa86>0x0)throw new Error(_0x220229(0x13c));return{'value':concat_typed_arrays(..._0x1821ee),'done':_0x377c60};}async function parse_header(_0x47654b,_0x2da991){const _0x106198=_0x5526ba;log(_0x106198(0xc5),_0x106198(0xcf));const _0x219d8b=_0x2da991['readable']['getReader']();try{const _0x55fe75=await read_vless_header(_0x219d8b,_0x47654b);return log('debug','VLESS\x20header\x20parsed\x20successfully'),_0x55fe75;}catch(_0x214806){log(_0x106198(0x100),_0x106198(0x138)+_0x214806[_0x106198(0xe8)]);throw new Error(_0x106198(0xc9)+_0x214806['message']);}finally{_0x219d8b['releaseLock']();}}function _0x4e57(_0x313c03,_0x1557e4){const _0x2c824d=_0x2c82();return _0x4e57=function(_0x4e571b,_0x35bd33){_0x4e571b=_0x4e571b-0xa3;let _0x44d65e=_0x2c824d[_0x4e571b];return _0x44d65e;},_0x4e57(_0x313c03,_0x1557e4);}async function connect_remote(_0x2d1ed1,_0x3e6af6){const _0x59670e=_0x5526ba,_0x56d4dc=0x1f40;try{const _0x2cc48f=await timed_connect(_0x2d1ed1,_0x3e6af6,_0x56d4dc);return _0x2cc48f[_0x59670e(0xc6)](!![]),_0x2cc48f[_0x59670e(0x10a)](!![],0x3e8),_0x2cc48f[_0x59670e(0x128)]=parseInt(SETTINGS[_0x59670e(0xbb)])*0x400,log(_0x59670e(0xc4),_0x59670e(0xa9)+_0x2d1ed1+':'+_0x3e6af6),_0x2cc48f;}catch(_0x2ffb09){log('error','Connection\x20failed:\x20'+_0x2ffb09[_0x59670e(0xe8)]);throw _0x2ffb09;}}function timed_connect(_0x312434,_0x1d2058,_0x3da7be){return new Promise((_0x564d64,_0x4545b4)=>{const _0x473161=_0x4e57,_0x2c81b2=net[_0x473161(0xe6)]({'host':_0x312434,'port':_0x1d2058}),_0x537648=setTimeout(()=>{const _0x4e414b=_0x473161;_0x4545b4(new Error(_0x4e414b(0xdf)));},_0x3da7be);_0x2c81b2['on'](_0x473161(0xf1),()=>{clearTimeout(_0x537648),_0x564d64(_0x2c81b2);}),_0x2c81b2['on'](_0x473161(0x100),_0x4b54ca=>{clearTimeout(_0x537648),_0x4545b4(_0x4b54ca);});});}function pipe_relay(){async function _0x146650(_0x3bf063,_0x470507,_0x9e2727){const _0x3ec110=_0x4e57,_0x69bc65=parseInt(SETTINGS[_0x3ec110(0xf6)]);if(_0x9e2727['length']>0x0){if(_0x470507[_0x3ec110(0x122)])_0x470507[_0x3ec110(0x116)](),_0x470507[_0x3ec110(0x122)](_0x9e2727),process[_0x3ec110(0xd2)](()=>_0x470507[_0x3ec110(0x150)]());else{const _0x135768=_0x470507[_0x3ec110(0x139)][_0x3ec110(0xad)]();try{await _0x135768['write'](_0x9e2727);}finally{_0x135768[_0x3ec110(0xdc)]();}}}try{_0x3bf063['pipe']?(_0x3bf063['pause'](),_0x3bf063['pipe'](_0x470507,{'end':!![],'highWaterMark':_0x69bc65}),_0x3bf063[_0x3ec110(0x13d)]()):await _0x3bf063[_0x3ec110(0xbc)][_0x3ec110(0x120)](_0x470507['writable'],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal['timeout'](SETTINGS[_0x3ec110(0x144)])});}catch(_0x915e72){!_0x915e72[_0x3ec110(0xe8)][_0x3ec110(0xa8)](_0x3ec110(0xe7))&&log(_0x3ec110(0x100),_0x3ec110(0x12c),_0x915e72[_0x3ec110(0xe8)]);throw _0x915e72;}}return _0x146650;}function socketToWebStream(_0x513d35){const _0x4c1833=_0x5526ba;let _0x4555cf,_0x311e68;return _0x513d35['on'](_0x4c1833(0x100),_0x49a21b=>{const _0x5e1ccd=_0x4c1833;log(_0x5e1ccd(0x100),'Socket\x20error:',_0x49a21b[_0x5e1ccd(0xe8)]),_0x4555cf?.['error'](_0x49a21b),_0x311e68?.['error'](_0x49a21b);}),{'readable':new ReadableStream({'start'(_0x41ef1a){const _0x11f269=_0x4c1833;_0x4555cf=_0x41ef1a,_0x513d35['on'](_0x11f269(0x119),_0x2dbe26=>{const _0x18276a=_0x11f269;try{_0x41ef1a[_0x18276a(0xea)](_0x2dbe26);}catch(_0x1639ef){log('error',_0x18276a(0xee),_0x1639ef[_0x18276a(0xe8)]);}}),_0x513d35['on']('end',()=>{const _0x25d11b=_0x11f269;try{_0x41ef1a[_0x25d11b(0xb0)]();}catch(_0x5c5a20){log(_0x25d11b(0x100),'Read\x20controller\x20close\x20error:',_0x5c5a20[_0x25d11b(0xe8)]);}});},'cancel'(){const _0x5c1ddf=_0x4c1833;_0x513d35[_0x5c1ddf(0xb8)]();}}),'writable':new WritableStream({'start'(_0x38e7ee){_0x311e68=_0x38e7ee;},'write'(_0x127841){return new Promise((_0x85b6d1,_0x3f91a4)=>{const _0x2b3beb=_0x4e57;if(_0x513d35[_0x2b3beb(0x121)]){_0x3f91a4(new Error(_0x2b3beb(0xb9)));return;}_0x513d35[_0x2b3beb(0x122)](_0x127841,_0x394e86=>{if(_0x394e86)_0x3f91a4(_0x394e86);else _0x85b6d1();});});},'close'(){const _0x453757=_0x4c1833;!_0x513d35[_0x453757(0x121)]&&_0x513d35['end']();},'abort'(_0x1bcec4){const _0x3aa526=_0x4c1833;_0x513d35[_0x3aa526(0xb8)](_0x1bcec4);}})};}function relay(_0x462546,_0x48a64e,_0x23d0c7,_0x36e3d8){const _0x34c674=_0x5526ba,_0x4187b8=pipe_relay();let _0x249d03=![];const _0x67d771=socketToWebStream(_0x23d0c7);function _0xf45f96(){const _0x33e3a6=_0x4e57;if(!_0x249d03){_0x249d03=!![];try{_0x23d0c7[_0x33e3a6(0xb8)]();}catch(_0x2c80fd){!_0x2c80fd[_0x33e3a6(0xe8)]['includes'](_0x33e3a6(0xe7))&&!_0x2c80fd[_0x33e3a6(0xe8)]['includes'](_0x33e3a6(0x115))&&log(_0x33e3a6(0x100),_0x33e3a6(0xd3)+_0x2c80fd[_0x33e3a6(0xe8)]);}}}const _0x1c0309=_0x4187b8(_0x48a64e,_0x67d771,_0x36e3d8[_0x34c674(0x119)])[_0x34c674(0x112)](_0x440d9b=>{const _0x414450=_0x34c674;!_0x440d9b['message'][_0x414450(0xa8)](_0x414450(0xe7))&&!_0x440d9b[_0x414450(0xe8)][_0x414450(0xa8)](_0x414450(0x115))&&log(_0x414450(0x100),_0x414450(0x146)+_0x440d9b[_0x414450(0xe8)]);})[_0x34c674(0x12e)](()=>{_0x48a64e['reading_done']&&_0x48a64e['reading_done']();}),_0x29ff13=_0x4187b8(_0x67d771,_0x48a64e,_0x36e3d8['resp'])[_0x34c674(0x112)](_0x48eb32=>{const _0x4ad604=_0x34c674;!_0x48eb32[_0x4ad604(0xe8)]['includes']('aborted')&&!_0x48eb32[_0x4ad604(0xe8)][_0x4ad604(0xa8)]('socket\x20hang\x20up')&&log('error','Download\x20error:\x20'+_0x48eb32[_0x4ad604(0xe8)]);});_0x29ff13[_0x34c674(0x12e)](()=>_0x1c0309)['finally'](_0xf45f96);}const sessions=new Map();class Session{constructor(_0x1924b2){const _0x5153c0=_0x5526ba;this['uuid']=_0x1924b2,this[_0x5153c0(0x130)]=0x0,this[_0x5153c0(0xa5)]=![],this['lastActivity']=Date[_0x5153c0(0x154)](),this[_0x5153c0(0x153)]=null,this['remote']=null,this[_0x5153c0(0x131)]=![],this[_0x5153c0(0x101)]=null,this[_0x5153c0(0x152)]=![],this['bufferedData']=new Map(),this[_0x5153c0(0xfc)]=![],this['pendingPackets']=[],this[_0x5153c0(0x118)]=null,this[_0x5153c0(0xb7)]=new Map(),log('debug',_0x5153c0(0xf3)+_0x1924b2);}async[_0x5526ba(0xda)](_0x1db261){const _0x9be329=_0x5526ba;if(this['initialized'])return!![];try{log('debug',_0x9be329(0xfd));const _0x139307=new ReadableStream({'start'(_0x423686){const _0x210aef=_0x9be329;_0x423686['enqueue'](_0x1db261),_0x423686[_0x210aef(0xb0)]();}}),_0x550519={'readable':_0x139307,'writable':new WritableStream()};return this[_0x9be329(0x153)]=await parse_header(SETTINGS[_0x9be329(0x11b)],_0x550519),log('info',_0x9be329(0xbd)+this['vlessHeader'][_0x9be329(0xdb)]+':'+this[_0x9be329(0x153)]['port']),this['remote']=await connect_remote(this[_0x9be329(0x153)][_0x9be329(0xdb)],this['vlessHeader']['port']),log(_0x9be329(0xc4),_0x9be329(0x159)),this['initialized']=!![],!![];}catch(_0xa1b44b){return log(_0x9be329(0x100),_0x9be329(0x12a)+_0xa1b44b[_0x9be329(0xe8)]),![];}}async['processPacket'](_0x3e9d47,_0x5d2696){const _0x31b653=_0x5526ba;try{this[_0x31b653(0xb7)][_0x31b653(0x123)](_0x3e9d47,_0x5d2696),log(_0x31b653(0xc5),_0x31b653(0x142)+_0x3e9d47+_0x31b653(0xeb)+_0x5d2696[_0x31b653(0x106)]);while(this[_0x31b653(0xb7)][_0x31b653(0xb5)](this['nextSeq'])){const _0x56fcd7=this[_0x31b653(0xb7)][_0x31b653(0x156)](this[_0x31b653(0x130)]);this[_0x31b653(0xb7)]['delete'](this[_0x31b653(0x130)]);if(!this[_0x31b653(0x131)]&&this[_0x31b653(0x130)]===0x0){if(!await this[_0x31b653(0xda)](_0x56fcd7))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x31b653(0x101)]=Buffer['from'](this[_0x31b653(0x153)]['resp']),await this[_0x31b653(0x125)](this[_0x31b653(0x153)][_0x31b653(0x119)]),this[_0x31b653(0x118)]&&this[_0x31b653(0xb3)]();}else{if(!this[_0x31b653(0x131)]){log(_0x31b653(0x137),_0x31b653(0xb6)+_0x3e9d47+_0x31b653(0xd7));continue;}await this[_0x31b653(0x125)](_0x56fcd7);}this['nextSeq']++,log('debug',_0x31b653(0x14b)+(this[_0x31b653(0x130)]-0x1));}if(this[_0x31b653(0xb7)][_0x31b653(0x151)]>SETTINGS[_0x31b653(0xaf)])throw new Error(_0x31b653(0x141));return!![];}catch(_0x3da20e){log(_0x31b653(0x100),_0x31b653(0xc7)+_0x3da20e[_0x31b653(0xe8)]);throw _0x3da20e;}}[_0x5526ba(0xb3)](){const _0x2dd997=_0x5526ba;if(!this[_0x2dd997(0x118)]||!this['responseHeader'])return;try{const _0x2fd458=this[_0x2dd997(0x118)][_0x2dd997(0x109)]?.[_0x2dd997(0xf4)]||_0x2dd997(0x14d),_0x993fe4=_0x2fd458==='h2';!this[_0x2dd997(0x152)]&&(log('debug',_0x2dd997(0xb4)+_0x2fd458+_0x2dd997(0x113)+this[_0x2dd997(0x101)][_0x2dd997(0x106)]+_0x2dd997(0x145)),this['currentStreamRes'][_0x2dd997(0x122)](this[_0x2dd997(0x101)]),this[_0x2dd997(0x152)]=!![]);if(_0x993fe4){this['currentStreamRes'][_0x2dd997(0x109)]['setNoDelay'](!![]);const _0x3b8c66=new require('stream')[_0x2dd997(0xa3)]({'transform'(_0x58864d,_0x594671,_0x3f4329){const _0x4b6e1e=_0x2dd997,_0x5a2ecb=0x4000;for(let _0x28df64=0x0;_0x28df64<_0x58864d[_0x4b6e1e(0x106)];_0x28df64+=_0x5a2ecb){this[_0x4b6e1e(0x157)](_0x58864d[_0x4b6e1e(0xfa)](_0x28df64,_0x28df64+_0x5a2ecb));}_0x3f4329();}});this[_0x2dd997(0x136)][_0x2dd997(0xce)](_0x3b8c66)[_0x2dd997(0xce)](this[_0x2dd997(0x118)]);}else this['remote']['pipe'](this[_0x2dd997(0x118)]);this['remote']['on'](_0x2dd997(0xe9),()=>{const _0x23341e=_0x2dd997;!this[_0x23341e(0x118)][_0x23341e(0xab)]&&this[_0x23341e(0x118)]['end']();}),this[_0x2dd997(0x136)]['on'](_0x2dd997(0x100),_0x1266e3=>{const _0x4699a1=_0x2dd997;log(_0x4699a1(0x100),_0x4699a1(0x111)+_0x1266e3[_0x4699a1(0xe8)]),!this[_0x4699a1(0x118)][_0x4699a1(0xab)]&&this[_0x4699a1(0x118)]['end']();});}catch(_0x40e32){log(_0x2dd997(0x100),_0x2dd997(0x132)+_0x40e32[_0x2dd997(0xe8)]),this[_0x2dd997(0x155)]();}}[_0x5526ba(0x103)](_0x2b9871,_0x5853e4){const _0x482357=_0x5526ba;return!_0x2b9871[_0x482357(0xaa)]&&_0x2b9871['writeHead'](0xc8,_0x5853e4),this[_0x482357(0x118)]=_0x2b9871,this[_0x482357(0x131)]&&this[_0x482357(0x101)]&&this[_0x482357(0xb3)](),_0x2b9871['on'](_0x482357(0xb0),()=>{const _0x4f1ab8=_0x482357;log(_0x4f1ab8(0xc4),_0x4f1ab8(0x107)),this[_0x4f1ab8(0x155)]();}),!![];}async[_0x5526ba(0x125)](_0x57efe6){const _0x3829f2=_0x5526ba;if(!this['remote']||this['remote'][_0x3829f2(0x121)])throw new Error(_0x3829f2(0xbe));return new Promise((_0x5bc436,_0x15520d)=>{const _0x20dc6d=_0x3829f2;this[_0x20dc6d(0x136)][_0x20dc6d(0x122)](_0x57efe6,_0x3b48d7=>{const _0x152dea=_0x20dc6d;_0x3b48d7?(log('error',_0x152dea(0xd1)+_0x3b48d7['message']),_0x15520d(_0x3b48d7)):_0x5bc436();});});}['cleanup'](){const _0x4f8493=_0x5526ba;!this['cleaned']&&(this[_0x4f8493(0xfc)]=!![],log(_0x4f8493(0xc5),'Cleaning\x20up\x20session\x20'+this[_0x4f8493(0x147)]),this[_0x4f8493(0x136)]&&(this[_0x4f8493(0x136)][_0x4f8493(0xb8)](),this[_0x4f8493(0x136)]=null),this['initialized']=![],this[_0x4f8493(0x152)]=![]);}}const metaInfo=execSync('curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27',{'encoding':_0x5526ba(0x126)}),ISP=metaInfo[_0x5526ba(0x10b)]();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync(_0x5526ba(0x13b),{'encoding':'utf-8'})[_0x5526ba(0x10b)]();}catch(_0x477c41){try{IP='['+execSync(_0x5526ba(0x102),{'encoding':_0x5526ba(0x126)})['trim']()+']';}catch(_0x48e0bf){log(_0x5526ba(0x100),_0x5526ba(0x11c),_0x48e0bf['message']),IP=_0x5526ba(0x158);}}const server=http['createServer']((_0x4e89c2,_0x59c6cb)=>{const _0x23eaf1=_0x5526ba,_0x3745f3={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':_0x23eaf1(0x11d),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x4e89c2[_0x23eaf1(0x114)]==='/'){_0x59c6cb[_0x23eaf1(0x13a)](0xc8,{'Content-Type':'text/plain'}),_0x59c6cb[_0x23eaf1(0xe9)](_0x23eaf1(0xcd));return;}if(_0x4e89c2[_0x23eaf1(0x114)]==='/'+SUB_PATH){const _0x234664=_0x23eaf1(0xf2)+UUID+'@'+IP+':443?encryption=none&security=tls&sni='+IP+_0x23eaf1(0x14a)+IP+'&path='+SETTINGS[_0x23eaf1(0xca)]+_0x23eaf1(0x14e)+NAME+'-'+ISP,_0x241285=Buffer[_0x23eaf1(0x134)](_0x234664)['toString']('base64');_0x59c6cb['writeHead'](0xc8,{'Content-Type':_0x23eaf1(0xf9)}),_0x59c6cb[_0x23eaf1(0xe9)](_0x241285+'\x0a');return;}const _0x59ae1f=_0x4e89c2['url'][_0x23eaf1(0xcc)](new RegExp(XPATH+_0x23eaf1(0x148)));if(!_0x59ae1f){_0x59c6cb[_0x23eaf1(0x13a)](0x194),_0x59c6cb[_0x23eaf1(0xe9)]();return;}const _0x2e4c32=_0x59ae1f[0x1],_0x17eb04=_0x59ae1f[0x2]?parseInt(_0x59ae1f[0x2]):null;if(_0x4e89c2[_0x23eaf1(0xd8)]===_0x23eaf1(0x110)&&!_0x17eb04){_0x3745f3[_0x23eaf1(0xc3)]=_0x23eaf1(0xfb),_0x3745f3['Transfer-Encoding']=_0x23eaf1(0xac);let _0x37ccd9=sessions['get'](_0x2e4c32);!_0x37ccd9&&(_0x37ccd9=new Session(_0x2e4c32),sessions[_0x23eaf1(0x123)](_0x2e4c32,_0x37ccd9),log(_0x23eaf1(0xc4),'Created\x20new\x20session\x20for\x20GET:\x20'+_0x2e4c32));_0x37ccd9['downstreamStarted']=!![];!_0x37ccd9[_0x23eaf1(0x103)](_0x59c6cb,_0x3745f3)&&(log(_0x23eaf1(0x100),'Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x2e4c32),!_0x59c6cb[_0x23eaf1(0xaa)]&&(_0x59c6cb[_0x23eaf1(0x13a)](0x1f4),_0x59c6cb['end']()),_0x37ccd9[_0x23eaf1(0x155)](),sessions[_0x23eaf1(0x14c)](_0x2e4c32));return;}if(_0x4e89c2[_0x23eaf1(0xd8)]===_0x23eaf1(0x11a)&&_0x17eb04!==null){let _0x5a4722=sessions['get'](_0x2e4c32);!_0x5a4722&&(_0x5a4722=new Session(_0x2e4c32),sessions[_0x23eaf1(0x123)](_0x2e4c32,_0x5a4722),log('info','Created\x20new\x20session\x20for\x20POST:\x20'+_0x2e4c32),setTimeout(()=>{const _0x1de1c6=_0x23eaf1,_0x4e5ae8=sessions[_0x1de1c6(0x156)](_0x2e4c32);_0x4e5ae8&&!_0x4e5ae8[_0x1de1c6(0xa5)]&&(log(_0x1de1c6(0x137),_0x1de1c6(0x10d)+_0x2e4c32+_0x1de1c6(0xe3)),_0x4e5ae8[_0x1de1c6(0x155)](),sessions[_0x1de1c6(0x14c)](_0x2e4c32));},SETTINGS[_0x23eaf1(0x144)]));let _0x5ed341=[],_0x4eb331=0x0,_0x289b8a=![];_0x4e89c2['on'](_0x23eaf1(0x119),_0x1ce88e=>{const _0x372553=_0x23eaf1;_0x4eb331+=_0x1ce88e[_0x372553(0x106)];if(_0x4eb331>SETTINGS[_0x372553(0xd5)]){!_0x289b8a&&(_0x59c6cb[_0x372553(0x13a)](0x19d),_0x59c6cb['end'](),_0x289b8a=!![]);return;}_0x5ed341[_0x372553(0x157)](_0x1ce88e);}),_0x4e89c2['on']('end',async()=>{const _0x175459=_0x23eaf1;if(_0x289b8a)return;try{const _0x3ec386=Buffer[_0x175459(0xe5)](_0x5ed341);log('info',_0x175459(0xe4)+_0x17eb04+_0x175459(0xeb)+_0x3ec386[_0x175459(0x106)]),await _0x5a4722[_0x175459(0x11e)](_0x17eb04,_0x3ec386),!_0x289b8a&&(_0x59c6cb[_0x175459(0x13a)](0xc8,_0x3745f3),_0x289b8a=!![]),_0x59c6cb['end']();}catch(_0x172cf5){log('error',_0x175459(0xde)+_0x172cf5['message']),_0x5a4722[_0x175459(0x155)](),sessions[_0x175459(0x14c)](_0x2e4c32),!_0x289b8a&&(_0x59c6cb[_0x175459(0x13a)](0x1f4),_0x289b8a=!![]),_0x59c6cb[_0x175459(0xe9)]();}});return;}_0x59c6cb[_0x23eaf1(0x13a)](0x194),_0x59c6cb[_0x23eaf1(0xe9)]();});server['on'](_0x5526ba(0x104),_0x3d3e90=>{const _0x35a8c3=_0x5526ba;log(_0x35a8c3(0xc5),_0x35a8c3(0xba)+(_0x3d3e90[_0x35a8c3(0xf4)]||'http/1.1'));});function _0x2c82(){const _0x370101=['Processed\x20packet\x20seq=','delete','http/1.1','&mode=packet-up#','log','uncork','size','headerSent','vlessHeader','now','cleanup','get','push','localhost','Remote\x20connection\x20established','Transform','118596YnecjZ','downstreamStarted','done','Failed\x20to\x20parse\x20hostname','includes','Connected\x20to\x20','headersSent','writableEnded','chunked','getWriter','1102920gHTasH','MAX_BUFFERED_POSTS','close','http','substr','_startDownstreamResponse','Sending\x20VLESS\x20response\x20header\x20(','has','Received\x20out\x20of\x20order\x20packet\x20seq=','pendingBuffers','destroy','Socket\x20is\x20destroyed','New\x20secure\x20connection\x20using:\x20','BUFFER_SIZE','readable','VLESS\x20header\x20parsed:\x20','Remote\x20connection\x20not\x20available','3412020Hjhuly','12gCxBMx','\x1b[32m','SUB_PATH','Content-Type','info','debug','setNoDelay','Process\x20packet\x20error:\x20','replaceAll','read\x20vless\x20header\x20error:\x20','XPATH','fill','match','Hello,\x20World\x0a','pipe','Starting\x20to\x20parse\x20VLESS\x20header','buffer','Failed\x20to\x20write\x20to\x20remote:\x20','nextTick','Cleanup\x20error:\x20','reset','MAX_POST_SIZE','\x1b[0m','\x20before\x20initialization','method','constructor','initializeVLESS','hostname','releaseLock','NAME','Failed\x20to\x20process\x20POST\x20request:\x20','connect\x20timeout','DOMAIN','3796392oqSFwf','base64','\x20timed\x20out\x20without\x20downstream','Processing\x20packet:\x20seq=','concat','createConnection','aborted','message','end','enqueue',',\x20size=','PORT','read','Read\x20controller\x20error:','net','header\x20length\x20too\x20short','connect','vless://','Created\x20new\x20session\x20with\x20UUID:\x20','alpnProtocol','4XgEOIi','CHUNK_SIZE','env','TCP_NODELAY','text/plain','slice','application/octet-stream','cleaned','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','unsupported\x20command:\x20','222485ueGqAz','error','responseHeader','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','startDownstream','secureConnection','LOG_LEVEL','length','Client\x20connection\x20closed','%2F','socket','setKeepAlive','trim','1040030ytiuOR','Session\x20','listen','275BwopCG','GET','Remote\x20error:\x20','catch','):\x20','url','socket\x20hang\x20up','cork','18MrdKKP','currentStreamRes','data','POST','UUID','Failed\x20to\x20get\x20IP\x20address:','no-store','processPacket','headersTimeout','pipeTo','destroyed','write','set','toString','_writeToRemote','utf-8','floor','bufferSize','child_process','Failed\x20to\x20initialize\x20VLESS:\x20','1024','Relay\x20error:','TCP_KEEPALIVE','finally','none','nextSeq','initialized','Error\x20starting\x20downstream:\x20','parse\x20hostname\x20failed','from','keepAliveTimeout','remote','warn','VLESS\x20header\x20parse\x20error:\x20','writable','writeHead','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','not\x20enough\x20data\x20to\x20read','resume','toISOString','\x1b[33m','8835932kTuKqJ','Too\x20many\x20buffered\x20packets','Buffered\x20packet\x20seq=','value','SESSION_TIMEOUT','\x20bytes','Upload\x20error:\x20','uuid','/([^/]+)(?:/([0-9]+))?$','\x1b[31m','&fp=chrome&allowInsecure=1&type=xhttp&host='];_0x2c82=function(){return _0x370101;};return _0x2c82();}function generatePadding(_0x2f15eb,_0x5ac56b){const _0x2cb808=_0x5526ba,_0x4e2651=_0x2f15eb+Math[_0x2cb808(0x127)](Math['random']()*(_0x5ac56b-_0x2f15eb));return Buffer[_0x2cb808(0x134)](Array(_0x4e2651)[_0x2cb808(0xcb)]('X')['join'](''))[_0x2cb808(0x124)](_0x2cb808(0xe2));}server[_0x5526ba(0x135)]=0x975e0,server[_0x5526ba(0x11f)]=0x98968,server['on'](_0x5526ba(0x100),_0x3698ca=>{const _0x120841=_0x5526ba;log(_0x120841(0x100),'Server\x20error:\x20'+_0x3698ca['message']);}),server[_0x5526ba(0x10e)](PORT,()=>{const _0x5930e3=_0x5526ba;console[_0x5930e3(0x14f)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
